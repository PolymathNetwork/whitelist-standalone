(window["webpackJsonpwhitelist-standalone"]=window["webpackJsonpwhitelist-standalone"]||[]).push([[0],{1e3:function(e,t){function r(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}r.keys=function(){return[]},r.resolve=r,e.exports=r,r.id=1e3},1142:function(e,t,r){"use strict";r.r(t);var n=r(1),a=r.n(n),c=r(7),o=r.n(c),i=(r(448),r(10)),s=r.n(i),l=r(96),d=r(198),u=r(189),E=r(1144),p=r(155),f=r(1149),h=r(9),m=r(426),y=r(1145),O=r(201),v=r(19),g=r.n(v),k={CONNECTING:"connecting",CONNECTED:"connected",CONNECTION_ERROR:"connection_error",RESET:"reset",ERROR:"error",FETCHED_TOKENS:"fetched_tokens",FETCHING_TOKENS:"fetching_tokens",SHAREHOLDERS_FETCHED:"shareholders_fetched",STORE_SHAREHOLDERS:"store_shareholders",RELOAD_SHAREHOLDERS:"reload_shareholders",TOKEN_SELECTED:"token_selected",DELETING_SHAREHOLDER:"deleting_shareholder",SHAREHOLDER_DELETED:"shareholder_deleted"},b=f.a.Text,S=f.a.Title;function R(e){var t=e.tokenSelectOpts,r=Object(n.useContext)(pe);return a.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:250,justifyContent:"flex-start"}},a.a.createElement(S,{level:3},"Please Select a Token"),a.a.createElement(b,{style:{paddingTop:20,paddingBottom:20,width:"100%"}},"Once you select a token, you will be able to manage token holders white-list by adding, editing or removing token holders."),a.a.createElement(p.a,{autoFocus:!0,showSearch:!0,style:{width:"100%",marginBottom:40},placeholder:"Select a token",optionFilterProp:"children",onChange:function(e){return r({type:k.TOKEN_SELECTED,selectedToken:e})},filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},t))}var C=r(423),w=r(196),x=r(1148),A=r(1152),T=r(68),D=r(1150),N=r(1151),_=r(1147),j=r(1143),I=r(1146),F=I.a.Column,H=f.a.Text;function L(e){return g()(e).format("YYYY-MM-DD")}function P(e){return e?a.a.createElement(n.Fragment,null,a.a.createElement(h.a,{style:{color:"#00AA5E"},type:"check-circle",theme:"filled"}),a.a.createElement("span",null,"   Yes")):a.a.createElement(n.Fragment,null,a.a.createElement(h.a,{style:{color:"#DB2C3E"},type:"close-circle",theme:"filled"}),a.a.createElement("span",null,"   No"))}var K=function(e){var t=e.shareholders,r=e.openForm,c=e.removeShareholders;return a.a.createElement(I.a,{dataSource:t,rowKey:"address"},a.a.createElement(F,{title:"Address",dataIndex:"address",key:"address",render:function(e){return a.a.createElement(H,null,w.utils.toChecksumAddress(e))}}),a.a.createElement(F,{title:"Can send after",dataIndex:"canSendAfter",key:"canSendAfter",render:function(e){return L(e)}}),a.a.createElement(F,{title:"Can receive after",dataIndex:"canReceiveAfter",key:"canReceiveAfter",render:function(e){return L(e)}}),a.a.createElement(F,{title:"KYC expiry",dataIndex:"kycExpiry",key:"kycExpiry",render:function(e){return L(e)}}),a.a.createElement(F,{title:"Can buy from STO",dataIndex:"canBuyFromSto",key:"canBuyFromSto",render:function(e){return P(e)}}),a.a.createElement(F,{title:"Is accredited",dataIndex:"isAccredited",key:"isAccredited",render:function(e){return P(e)}}),a.a.createElement(F,{render:function(e,t){return a.a.createElement(n.Fragment,null,a.a.createElement(T.a,{onClick:function(){return r(t.address)}},a.a.createElement(h.a,{type:"edit",theme:"filled"})),a.a.createElement(T.a,{onClick:function(){return c([t.address])}},a.a.createElement(h.a,{type:"delete",theme:"filled"})))}}))};function B(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function G(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?B(r,!0).forEach(function(t){Object(u.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var M=x.a.Item,U={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},Y={address:"",canSendAfter:g()().add(1,"hour"),canReceiveAfter:g()().add(1,"hour"),kycExpiry:g()().add(1,"year"),canBuyFromSto:!0,isAccredited:!1},X={editIndex:"",visible:!1,ongoingTx:!1},q=function(e,t){switch(t.type){case"OPEN_FORM":return G({},e,{visible:!0,editIndex:t.payload.editIndex});case"CLOSE_FORM":return G({},e,{editIndex:"",visible:!1,ongoingTx:!1});case"TX_SEND":return G({},e,{ongoingTx:!0});case"TX_RECEIPT":return G({},e,{ongoingTx:!1,visible:!1,error:"",editIndex:""});case"TX_ERROR":return G({},e,{error:t.payload.error,ongoingTx:!1});default:return e}},W=function(e){var t=e.modifyWhitelist,r=e.shareholders,c=e.removeShareholders,o=Object(C.a)(),i=o.getFieldDecorator,u=o.setFieldsValue,E=o.resetFields,p=o.validateFields,f=Object(n.useReducer)(q,X),h=Object(d.a)(f,2),y=h[0],O=h[1],v=y.visible,g=y.editIndex,k=y.ongoingTx,b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";O({type:"OPEN_FORM",payload:{editIndex:e}})},S=function(){var e=Object(l.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:p(["address","canSendAfter","canReceiveAfter","kycExpiry","canBuyFromSto","isAccredited"],{force:!0}).then(function(){var e=Object(l.a)(s.a.mark(function e(r){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return O({type:"TX_SEND"}),r.canSendAfter=r.canSendAfter.toDate(),r.canReceiveAfter=r.canReceiveAfter.toDate(),r.kycExpiry=r.kycExpiry.toDate(),e.prev=4,e.next=7,t([r]);case 7:O({type:"TX_RECEIPT"}),E(),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(4),O({type:"TX_ERROR",payload:{error:e.t0.message}}),A.a.error(e.t0.message);case 15:case"end":return e.stop()}},e,null,[[4,11]])}));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),R=r.filter(function(e){return e.address===g})[0];return Object(n.useEffect)(function(){u(R||Y)},[R,u]),a.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},a.a.createElement(T.a,{type:"primary",style:{marginBottom:20,alignSelf:"flex-end"},onClick:b},"Add new"),a.a.createElement(K,{shareholders:r,removeShareholders:c,openForm:b}),a.a.createElement(D.a,{title:R?"Edit tokenholder":"Add a new tokenholder",okText:"Save",closable:!1,visible:v,footer:null},a.a.createElement(m.a,{spinning:k,size:"large"},a.a.createElement(x.a,U,a.a.createElement(M,{name:"address",label:"Address"},i("address",{rules:[{required:!0},{validator:function(e,t,r){R||w.utils.isAddress(t)?r():r("Address is invalid")}},{validator:function(e,t,n){var a;R||(a=t,void 0===r.find(function(e){return e.address.toUpperCase()===a.toUpperCase()}))?n():n("Tokenholder is already present in the whitelist")}}]})(a.a.createElement(N.a,{disabled:!!R}))),a.a.createElement(M,{name:"canSendAfter",label:"Can Send after"},i("canSendAfter",{rules:[{required:!0}]})(a.a.createElement(_.a,null))),a.a.createElement(M,{name:"canReceiveAfter",label:"Can Receive After"},i("canReceiveAfter",{rules:[{required:!0}]})(a.a.createElement(_.a,null))),a.a.createElement(M,{name:"kycExpiry",label:"KYC Expiry"},i("kycExpiry",{rules:[{required:!0}]})(a.a.createElement(_.a,null))),a.a.createElement(M,{name:"canBuyFromSto",label:"Can Buy from STO"},i("canBuyFromSto",{valuePropName:"checked"})(a.a.createElement(j.a,null))),a.a.createElement(M,{name:"isAccredited",label:"Accredited"},i("isAccredited",{valuePropName:"checked"})(a.a.createElement(j.a,null))),a.a.createElement(M,null,a.a.createElement(T.a,{onClick:function(){O({type:"CLOSE_FORM"}),E()}},"cancel"),a.a.createElement(T.a,{onClick:S},"save"))))))},z={1:{polymathRegistryAddress:"0xdfabf3e4793cd30affb47ab6fa4cf4eef26bbc27"},42:{polymathRegistryAddress:"0x5b215a7d39ee305ad28da29bf2f0425c6c2a00b3"}};function J(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function V(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?J(r,!0).forEach(function(t){Object(u.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var $=E.a.Content,Q=E.a.Header,Z=p.a.Option,ee=f.a.Text,te={shareholders:[],tokens:void 0,editingShareholder:!1,selectedToken:void 0,fetching:!1,userAddress:"",polyClient:void 0,connected:!1,error:"",networkId:0,tip:""};function re(e,t){switch(console.log("ACTION",t),t.type){case k.CONNECTING:return V({},e,{connecting:!0,tip:"Connecting...",error:void 0});case k.CONNECTED:return V({},e,{polyClient:t.polyClient,networkId:t.networkId,userAddress:t.userAddress,connecting:!1,tip:"",error:void 0});case k.CONNECTION_ERROR:return V({},e,{error:t.error,tokens:void 0,connecting:!1,tip:""});case k.FETCHING_TOKENS:return V({},e,{fetching:!0,tip:"Fetching tokens"});case k.FETCHED_TOKENS:var r=t.tokens;return V({},e,{tokenSelectOpts:t.tokenSelectOpts,tokens:r,fetching:!1,tip:""});case k.TOKEN_SELECTED:return V({},e,{selectedToken:t.selectedToken,tip:"Loading tokenholders...",fetching:!0});case k.RELOAD_SHAREHOLDERS:return V({},e,{fetching:!0,tip:"Reloading tokenholders...",reloadShareholders:!0});case k.SHAREHOLDERS_FETCHED:var n=t.shareholders;return V({},e,{shareholders:n=n.map(function(e){return Object.assign({},e,{canReceiveAfter:g()(e.canReceiveAfter),canSendAfter:g()(e.canSendAfter),kycExpiry:g()(e.kycExpiry)})}),fetching:!1,tip:"",reloadShareholders:!1});case k.DELETING_SHAREHOLDER:return V({},e,{fetching:!0,tip:"Deleting token holder"});case k.SHAREHOLDER_DELETED:return V({},e,{fetching:!1,tip:""});case k.ERROR:return V({},e,{error:t.error,fetching:!1});default:throw new Error('Unrecognized action "'.concat(t.type,'"'))}}function ne(e){var t=e.networkId;t=t.toString();return a.a.createElement(n.Fragment,null,a.a.createElement(h.a,{type:"global",style:{marginRight:10,marginLeft:20}}),a.a.createElement(ee,null,{0:"Disconnected",1:"Mainnet",42:"Kovan"}[t]))}function ae(e){var t=e.userAddress;return t?a.a.createElement(n.Fragment,null,a.a.createElement(h.a,{type:"user",style:{marginRight:5,marginLeft:10}}),a.a.createElement(ee,null,t)):null}var ce=function(){var e=Object(n.useReducer)(re,te),t=Object(d.a)(e,2),r=t[0],c=t[1],o=r.shareholders,i=r.tokens,u=r.selectedToken,p=r.fetching,f=r.tip,h=r.userAddress,v=r.connecting,g=r.error,b=r.networkId,S=r.connected,C=r.polyClient,w=r.reloadShareholders,x=r.tokenSelectOpts;function A(){return(A=Object(l.a)(s.a.mark(function e(t){var r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i[u].shareholders.modifyData({shareholderData:t});case 2:return r=e.sent,e.next=5,r.run();case 5:c({type:k.RELOAD_SHAREHOLDERS});case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function T(){return(T=Object(l.a)(s.a.mark(function e(t){var r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("App.removeShareholders",t),c({type:k.DELETING_SHAREHOLDER}),e.prev=2,e.next=5,i[u].shareholders.revokeKyc({shareholderAddresses:t});case 5:return r=e.sent,e.next=8,r.run();case 8:c({type:k.SHAREHOLDER_DELETED}),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(2);case 13:c({type:k.RELOAD_SHAREHOLDERS});case 14:case"end":return e.stop()}},e,null,[[2,11]])}))).apply(this,arguments)}return Object(n.useEffect)(function(){function e(){return(e=Object(l.a)(s.a.mark(function e(t){var r,n,a,c;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:k.CONNECTING}),e.prev=1,e.next=4,O.browserUtils.getNetworkId();case 4:return r=e.sent,e.next=7,O.browserUtils.getCurrentAddress();case 7:if(n=e.sent,[-1,1,42].includes(r)){e.next=11;break}return t({type:k.CONNECTION_ERROR,error:"Please switch to either Main or Kovan network"}),e.abrupt("return");case 11:return a=z[r],c=new O.Polymath,e.next=15,c.connect(a);case 15:t({type:k.CONNECTED,networkId:r,polyClient:c,userAddress:n}),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(1),t({type:k.CONNECTION_ERROR,error:e.t0.message});case 21:case"end":return e.stop()}},e,null,[[1,18]])}))).apply(this,arguments)}S||function(t){e.apply(this,arguments)}(c)},[S]),Object(n.useEffect)(function(){function e(){return(e=Object(l.a)(s.a.mark(function e(t,r,n){var c,o;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:k.FETCHING_TOKENS}),e.next=3,r.getSecurityTokens({userAddress:n});case 3:c=e.sent,o=c.map(function(e,t){return a.a.createElement(Z,{value:t,key:t},e.symbol)}),t({type:k.FETCHED_TOKENS,tokens:c,tokenSelectOpts:o});case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}C&&h&&!i&&function(t,r,n){e.apply(this,arguments)}(c,C,h)},[h,C,i]),Object(n.useEffect)(function(){function e(){return(e=Object(l.a)(s.a.mark(function e(t,r){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.shareholders.getShareholders();case 2:n=e.sent,t({type:k.SHAREHOLDERS_FETCHED,shareholders:n});case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}!0===w|void 0!==u&&function(t,r){e.apply(this,arguments)}(c,i[u])},[i,u,w]),a.a.createElement("div",{className:"App"},a.a.createElement(pe.Provider,{value:c},a.a.createElement(m.a,{spinning:p||v,tip:f,size:"large"},a.a.createElement(E.a,null,a.a.createElement(Q,{style:{backgroundColor:"white",display:"flex",flexDirection:"row",justifyContent:"flex-end",alignItems:"center"}},a.a.createElement(ne,{networkId:b}),a.a.createElement(ae,{userAddress:h})),a.a.createElement($,{style:{padding:50,backgroundColor:"#FAFDFF"}},g&&a.a.createElement(y.a,{message:g,type:"error"}),h&&a.a.createElement(R,{tokenSelectOpts:x}),void 0!==u&&a.a.createElement(W,{modifyWhitelist:function(e){return A.apply(this,arguments)},removeShareholders:function(e){return T.apply(this,arguments)},shareholders:o}))))))},oe=r(437),ie=r(438),se=r(440),le=r(439),de=r(441),ue=function(e){function t(e){var r;return Object(oe.a)(this,t),(r=Object(se.a)(this,Object(le.a)(t).call(this,e))).state={hasError:!1},r}return Object(de.a)(t,e),Object(ie.a)(t,[{key:"componentDidCatch",value:function(e,t){var r;(r=console).error.apply(r,["ErrorBoundary"].concat(Array.prototype.slice.call(arguments)))}},{key:"render",value:function(){return this.state.hasError?a.a.createElement("h1",null,"Something went wrong."):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),t}(a.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Ee=a.a.createContext(null),pe=t.default=Ee;o.a.render(a.a.createElement(ue,null,a.a.createElement(ce,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},443:function(e,t,r){e.exports=r(1142)},448:function(e,t,r){},526:function(e,t){},528:function(e,t){},548:function(e,t){},550:function(e,t){},885:function(e,t){}},[[443,1,2]]]);
//# sourceMappingURL=main.e2fd924d.chunk.js.map